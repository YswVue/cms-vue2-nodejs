"use strict";(self["webpackChunkvue2_cms_admin"]=self["webpackChunkvue2_cms_admin"]||[]).push([[970],{970:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"list_head",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("分类列表")])]),t("el-tree",{ref:"tree",attrs:{load:e.loadNode,lazy:"","node-key":"cate_id",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function({node:i,data:s}){return t("span",{staticClass:"custom-tree-node"},[t("span",[e._v(e._s(i.label))]),t("span",[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"category:edit",expression:"'category:edit'"}],attrs:{disabled:0===s.cate_id,icon:"el-icon-edit",type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.openEditDialog(i,s)}}},[e._v(" 编辑 ")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"category:create",expression:"'category:create'"}],attrs:{icon:"el-icon-circle-plus-outline",type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.openInsertDialog(i,s)}}},[e._v(" 添加 ")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"category:remove",expression:"'category:remove'"}],attrs:{disabled:0===s.cate_id,icon:"el-icon-delete",type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.handleRemove(s)}}},[e._v(" 删除 ")])],1)])}}])}),t("el-dialog",{attrs:{title:"添加分类",visible:e.insertDialogVisible},on:{"update:visible":function(t){e.insertDialogVisible=t},close:function(t){return e.handleCloseDialog("insertForm")}}},[t("el-form",{ref:"insertForm",attrs:{model:e.insertForm,rules:e.rules,"status-icon":"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"分类名称",prop:"cate_name"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.insertForm.cate_name,callback:function(t){e.$set(e.insertForm,"cate_name",t)},expression:"insertForm.cate_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.insertDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleInsert}},[e._v("添 加")])],1)],1),t("el-dialog",{attrs:{title:"编辑分类",visible:e.editDialogVisible},on:{"update:visible":function(t){e.editDialogVisible=t},close:function(t){return e.handleCloseDialog("editForm")}}},[t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules,"status-icon":"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"分类名称",prop:"cate_name"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.editForm.cate_name,callback:function(t){e.$set(e.editForm,"cate_name",t)},expression:"editForm.cate_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleEdit}},[e._v("保 存")])],1)],1)],1)},a=[],r=i(9551),o={name:"List",data(){return{data:[],defaultProps:{children:"children",label:"cate_name"},insertDialogVisible:!1,insertForm:{cate_name:"",parent_id:""},editDialogVisible:!1,editForm:{cate_name:"",parent_id:"",cate_id:""},current_node:"",rules:{cate_name:[{required:!0,message:"请输入分类名称！",trigger:"blur"}]}}},mounted(){},methods:{async loadNode(e,t){let i=[{cate_id:0,cate_name:"全部分类"}];if(0===e.level)return t(i);let{cate_id:s}=e.data,{status:a,msg:o,data:n}=await r.WD.subCate({cate_id:s});a&&t(n)},handleNodeClick(e){console.log(e)},handleCloseDialog(e){this.$refs[e].resetFields()},openInsertDialog(e,t){this.current_node=e,this.insertForm.parent_id=t.cate_id,this.insertDialogVisible=!0},handleInsert(){this.$refs.insertForm.validate((async e=>{if(e){let{status:e,msg:t,data:i}=await r.WD.create({...this.insertForm});if(e){let e={...this.insertForm,...i};this.$refs.tree.append(e,this.current_node),this.$message.success(t),this.insertDialogVisible=!1}else this.$message.error(t)}}))},openEditDialog(e,t){this.current_node=e,this.editForm={...t},this.editDialogVisible=!0},handleEdit(){this.$refs.editForm.validate((async e=>{if(e){let{status:e,msg:t}=await r.WD.edit({...this.editForm});e?(this.current_node.data={...this.editForm},this.editDialogVisible=!1,this.$message.success(t)):this.$message.error(t)}}))},handleRemove(e){if(e.children&&e.children.length)return void this.$message.error("拥有子级分类，无法删除！");let{cate_id:t}=e;this.$confirm("此操作将永久删除该链接, 是否继续?","确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then((async()=>{let{status:i,msg:s}=await r.WD.remove({cate_id:t});i?(this.$refs.tree.remove(e),this.$message.success(s)):this.$message.error(s)})).catch((()=>{this.$message.info("已取消删除")}))}}},n=o,l=i(1001),c=(0,l.Z)(n,s,a,!1,null,"8eb824f2",null),d=c.exports}}]);
//# sourceMappingURL=970.6b2c057d.js.map