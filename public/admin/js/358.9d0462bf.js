"use strict";(self["webpackChunkvue2_cms_admin"]=self["webpackChunkvue2_cms_admin"]||[]).push([[358],{5969:function(t,e,a){a.d(e,{Z:function(){return c}});var s=function(){var t=this,e=t._self._c;return e("el-upload",{staticClass:"avatar-uploader",attrs:{"on-success":t.handleUploadSuccess,"on-error":t.handleUploadError,"before-upload":t.beforeAvatarUpload,accept:"image/*","show-file-list":!1,data:t.data,action:t.action,headers:t.headers}},[t.picture?e("img",{staticClass:"avatar",attrs:{src:t.picture}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])},r=[],o={model:{prop:"picture",event:"change"},props:{data:{type:Object,default:()=>({type:"common"})},headers:{type:Object,default:()=>({Authorization:`Bearer ${sessionStorage.access_token}`})},action:{type:String,default:"/upload/common/"},picture:{type:String,default:""}},data(){return{}},methods:{beforeAvatarUpload(t){let e=/^image\/(jpeg||png)$/;const a=e.test(t.type),s=t.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),s||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&s},handleUploadError(t,e,a){let{status:s,message:r}=t;switch(s){case 400:let{status:t,msg:e}=JSON.parse(r);this.$message.error(e);break;case 401:let{code:a}=JSON.parse(r);this.$message.error(`错误代码401,${a},请重新登录`);break;default:break}},handleUploadSuccess(t,e,a){let{status:s,msg:r,src:o}=t;s&&(this.$emit("change",o),this.$message.success(r))}}},i=o,l=a(1001),n=(0,l.Z)(i,s,r,!1,null,"b38c2fa8",null),c=n.exports},4490:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var s=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"box-card"},[e("div",{attrs:{slot:"header"},slot:"header"},[e("span",[t._v("编辑文章")])]),e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"标题",prop:"title"}},[e("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),e("el-form-item",{attrs:{label:"描述",prop:"description"}},[e("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),e("el-form-item",{attrs:{label:"分类"}},[e("el-col",{attrs:{span:6}},[e("el-select",{attrs:{placeholder:"请选择一级分类"},on:{change:t.handleCategoryChange},model:{value:t.form.cate_1st,callback:function(e){t.$set(t.form,"cate_1st",e)},expression:"form.cate_1st"}},t._l(t.cate_1st_options,(function(t){return e("el-option",{key:t.cate_id,attrs:{label:t.cate_name,value:t.cate_id}})})),1)],1),e("el-col",{attrs:{span:6}},[e("el-select",{attrs:{placeholder:"请选择二级分类"},model:{value:t.form.cate_2nd,callback:function(e){t.$set(t.form,"cate_2nd",e)},expression:"form.cate_2nd"}},t._l(t.cate_2nd_options,(function(t){return e("el-option",{key:t.cate_id,attrs:{label:t.cate_name,value:t.cate_id}})})),1)],1)],1),e("el-form-item",{attrs:{label:"图片",prop:"main_photo"}},[e("ImgUpload",{model:{value:t.form.main_photo,callback:function(e){t.$set(t.form,"main_photo",e)},expression:"form.main_photo"}})],1),e("el-form-item",{attrs:{label:"内容",prop:"content"}},[e("txtEditor",{attrs:{content:t.form.content},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.handleEdit}},[t._v("发布文章")])],1)],1)],1)},r=[],o=a(9551),i=a(5969),l=a(51),n={name:"Edit",components:{ImgUpload:i.Z,txtEditor:l.Z},data(){return{form:{cate_1st:"",cate_2nd:"",title:"",description:"",main_photo:"",content:""},cate_1st_options:[],cate_2nd_options:[],rules:{main_photo:[{required:!0,message:"请上传图片！",trigger:"blur"}],title:[{required:!0,message:"请输入文章标题！",trigger:"blur"}],description:[{required:!0,message:"请输入文章描述！",trigger:"blur"}],content:[{required:!0,message:"请输入文章内容！",trigger:"blur"}]}}},async created(){let{article_id:t}=this.$route.params;this.init(t)},methods:{async init(t){let{status:e,data:a}=await o.WD.list();e&&(this.cate_1st_options={...a});let{status:s,data:r}=await o.d2.detail({article_id:t});s&&(this.form={...r});let{cate_1st:i}=r,{status:l,data:n}=await o.WD.subCate({cate_id:i});l&&(this.cate_2nd_options={...n})},async handleCategoryChange(t){let{status:e,data:a}=await o.WD.subCate({cate_id:t});e&&(this.cate_2nd_options={...a}),this.form.cate_2nd=this.cate_2nd_options[0]?.cate_id},async handleEdit(){try{let t=await this.$refs.form.validate();if(t){let{status:t,msg:e}=await o.d2.edit({...this.form});t?this.$message.success(e):this.$message.error(e)}}catch(t){this.$message.error(t)}}}},c=n,d=a(1001),m=(0,d.Z)(c,s,r,!1,null,"723bb370",null),p=m.exports}}]);
//# sourceMappingURL=358.9d0462bf.js.map