"use strict";(self["webpackChunkvue2_cms_admin"]=self["webpackChunkvue2_cms_admin"]||[]).push([[611],{5969:function(e,t,r){r.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("el-upload",{staticClass:"avatar-uploader",attrs:{"on-success":e.handleUploadSuccess,"on-error":e.handleUploadError,"before-upload":e.beforeAvatarUpload,accept:"image/*","show-file-list":!1,data:e.data,action:e.action,headers:e.headers}},[e.picture?t("img",{staticClass:"avatar",attrs:{src:e.picture}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])},s=[],l={model:{prop:"picture",event:"change"},props:{data:{type:Object,default:()=>({type:"common"})},headers:{type:Object,default:()=>({Authorization:`Bearer ${sessionStorage.access_token}`})},action:{type:String,default:"/upload/common/"},picture:{type:String,default:""}},data(){return{}},methods:{beforeAvatarUpload(e){let t=/^image\/(jpeg||png)$/;const r=t.test(e.type),i=e.size/1024/1024<2;return r||this.$message.error("上传头像图片只能是 JPG 格式!"),i||this.$message.error("上传头像图片大小不能超过 2MB!"),r&&i},handleUploadError(e,t,r){let{status:i,message:s}=e;switch(i){case 400:let{status:e,msg:t}=JSON.parse(s);this.$message.error(t);break;case 401:let{code:r}=JSON.parse(s);this.$message.error(`错误代码401,${r},请重新登录`);break;default:break}},handleUploadSuccess(e,t,r){let{status:i,msg:s,src:l}=e;i&&(this.$emit("change",l),this.$message.success(s))}}},a=l,o=r(1001),n=(0,o.Z)(a,i,s,!1,null,"b38c2fa8",null),c=n.exports},5611:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"list_head",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("轮播图列表")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"promotion:slide:create",expression:"'promotion:slide:create'"}],attrs:{type:"primary",icon:"el-icon-circle-plus-outline",plain:"",size:"mini"},on:{click:function(t){e.insertDialogVisible=!0}}},[e._v("添加轮播图")])],1),t("el-table",{attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"slide_id",label:"#",width:"100"}}),t("el-table-column",{attrs:{prop:"title",label:"链接标题"}}),t("el-table-column",{attrs:{label:"轮播图片"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-image",{attrs:{src:e.row.picture}})]}}])}),t("el-table-column",{attrs:{label:"跳转地址"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-link",{attrs:{href:r.row.url,target:r.row.target,underline:!1}},[e._v(" "+e._s(r.row.url))])]}}])}),t("el-table-column",{attrs:{label:"跳转方式"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("span",[e._v(e._s("_self"===r.row.target?"本页面打开":"新页面打开"))])]}}])}),t("el-table-column",{attrs:{label:"排序数字"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-tag",{attrs:{type:"success"}},[e._v(e._s(r.row.slide_order))])]}}])}),t("el-table-column",{attrs:{label:"添加日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.loacleTimestamp(t.row.create_date))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"promotion:slide:edit",expression:"'promotion:slide:edit'"}],attrs:{icon:"el-icon-edit",size:"mini",type:"primary"},on:{click:function(t){return e.openEditDialog(r.row)}}},[e._v("编辑")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"promotion:slide:remove",expression:"'promotion:slide:remove'"}],attrs:{plain:"",size:"mini",icon:"el-icon-delete",type:"danger"},on:{click:function(t){return e.handleRemove(r.row.slide_id,r.$index)}}},[e._v("删除")])]}}])})],1),t("el-dialog",{attrs:{title:"添加轮播图",visible:e.insertDialogVisible},on:{"update:visible":function(t){e.insertDialogVisible=t},close:function(t){return e.handleCloseDialog("insertForm")}}},[t("el-form",{ref:"insertForm",attrs:{model:e.insertForm,rules:e.rules,"status-icon":"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"轮播图片",prop:"picture"}},[t("ImgUpload",{model:{value:e.insertForm.picture,callback:function(t){e.$set(e.insertForm,"picture",t)},expression:"insertForm.picture"}})],1),t("el-form-item",{attrs:{label:"标题文字",prop:"title"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.insertForm.title,callback:function(t){e.$set(e.insertForm,"title",t)},expression:"insertForm.title"}})],1),t("el-form-item",{attrs:{label:"链接地址",prop:"url"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.insertForm.url,callback:function(t){e.$set(e.insertForm,"url",t)},expression:"insertForm.url"}})],1),t("el-form-item",{attrs:{label:"跳转方式",prop:"target"}},[t("el-radio-group",{model:{value:e.insertForm.target,callback:function(t){e.$set(e.insertForm,"target",t)},expression:"insertForm.target"}},[t("el-radio",{attrs:{label:"_blank"}},[e._v("新页面打开")]),t("el-radio",{attrs:{label:"_self"}},[e._v("本页面打开")])],1)],1),t("el-form-item",{attrs:{label:"显示顺序",prop:"slide_order"}},[t("el-input",{attrs:{type:"number",autocomplete:"off",placeholder:"输入数字，数字越小越靠前"},model:{value:e.insertForm.slide_order,callback:function(t){e.$set(e.insertForm,"slide_order",t)},expression:"insertForm.slide_order"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.insertDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleInsert}},[e._v("添 加")])],1)],1),t("el-dialog",{attrs:{title:"编辑轮播图",visible:e.editDialogVisible},on:{"update:visible":function(t){e.editDialogVisible=t},close:function(t){return e.handleCloseDialog("editForm")}}},[t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules,"status-icon":"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"轮播图",prop:"picture"}},[t("ImgUpload",{model:{value:e.editForm.picture,callback:function(t){e.$set(e.editForm,"picture",t)},expression:"editForm.picture"}})],1),t("el-form-item",{attrs:{label:"标题文字",prop:"title"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.editForm.title,callback:function(t){e.$set(e.editForm,"title",t)},expression:"editForm.title"}})],1),t("el-form-item",{attrs:{label:"链接地址",prop:"url"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.editForm.url,callback:function(t){e.$set(e.editForm,"url",t)},expression:"editForm.url"}})],1),t("el-form-item",{attrs:{label:"显示顺序",prop:"slide_order"}},[t("el-input",{attrs:{type:"number",autocomplete:"off"},model:{value:e.editForm.slide_order,callback:function(t){e.$set(e.editForm,"slide_order",t)},expression:"editForm.slide_order"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleEdit}},[e._v("保 存")])],1)],1)],1)},s=[],l=(r(7658),r(9551)),a=r(5969),o={name:"List",components:{ImgUpload:a.Z},data(){return{tableData:[],insertDialogVisible:!1,insertForm:{slide_id:"",title:"",url:"",slide_order:"",picture:"",target:"",create_date:(new Date).toLocaleString()},editForm:{title:"",url:"",slide_order:"",picture:"",target:""},editDialogVisible:!1,current_slide:"",rules:{picture:[{required:!0,message:"请上传图片！",trigger:"blur"}],title:[{required:!0,message:"请输入标题文字！",trigger:"blur"}],url:[{required:!0,message:"请输入网站地址！",trigger:"blur"},{pattern:/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?/,message:"请正确输入网站地址！",trigger:"blur"}],slide_order:[{required:!0,message:"请输入排序位置(数字)！",trigger:"blur"}]}}},created(){this.loadList()},computed:{loacleTimestamp(){return e=>new Date(e).toLocaleString()}},methods:{async loadList(){let{status:e,msg:t,data:r}=await l.Mi.list();e&&(this.tableData=r)},openEditDialog(e){this.current_slide=e,this.editForm={...e},this.editDialogVisible=!0},handleCloseDialog(e){this.$refs[e].resetFields()},async handleEdit(){try{let e=await this.$refs.editForm.validate();if(e){let{status:e,msg:t}=await l.Mi.edit({...this.editForm});e?(Object.assign(this.current_slide,this.editForm),this.editDialogVisible=!1,this.$message.success(t)):this.$message.error(t)}}catch(e){}},handleRemove(e,t){this.$confirm("此操作将永久删除该角色, 是否继续?","确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then((async()=>{let{status:r,msg:i}=await l.Mi.remove({slide_id:e});r?(this.tableData.splice(t,1),this.$message.success(i)):this.$message.error(i)})).catch((()=>{this.$message.info("已取消删除")}))},handleInsert(){this.$refs.insertForm.validate((async e=>{if(e){let{status:e,msg:t,data:r}=await l.Mi.create({...this.insertForm});e?(this.tableData.push({...this.insertForm,...r}),this.insertDialogVisible=!1,this.$message.success(t)):this.$message.error(t)}}))}}},n=o,c=r(1001),u=(0,c.Z)(n,i,s,!1,null,"327ad3e2",null),d=u.exports}}]);
//# sourceMappingURL=611.46ad404f.js.map