"use strict";(self["webpackChunkvue2_cms_admin"]=self["webpackChunkvue2_cms_admin"]||[]).push([[149],{1149:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var i=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"list_head",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("标签列表")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"article:tag:create",expression:"'article:tag:create'"}],attrs:{type:"primary",icon:"el-icon-circle-plus-outline",plain:"",size:"mini"},on:{click:function(t){e.insertDialogVisible=!0}}},[e._v("添加标签")])],1),t("el-table",{attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"tag_id",label:"#"}}),t("el-table-column",{attrs:{prop:"tag_name",label:"标签名称"}}),t("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.loacleTimestamp(t.row.create_date))+" ")]}}])}),t("el-table-column",{attrs:{label:"编辑时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.loacleTimestamp(t.row.update_date))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"article:tag:edit",expression:"'article:tag:edit'"}],attrs:{type:"primary",icon:"el-icon-edit",plain:"",size:"mini"},on:{click:function(t){return e.openEditDialog(a.row)}}},[e._v("编辑")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"article:tag:remove",expression:"'article:tag:remove'"}],attrs:{plain:"",size:"mini",icon:"el-icon-delete",type:"danger"},on:{click:function(t){return e.handleRemove(a.row.tag_id,a.$index)}}},[e._v("删除")])]}}])})],1),t("el-dialog",{attrs:{title:"添加标签",visible:e.insertDialogVisible},on:{"update:visible":function(t){e.insertDialogVisible=t},close:function(t){return e.handleCloseDialog("insertForm")}}},[t("el-form",{ref:"insertForm",attrs:{model:e.insertForm,rules:e.rules,"status-icon":"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"标签名称",prop:"tag_name"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.insertForm.tag_name,callback:function(t){e.$set(e.insertForm,"tag_name",t)},expression:"insertForm.tag_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.insertDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleInsert}},[e._v("添 加")])],1)],1),t("el-dialog",{attrs:{title:"编辑标签",visible:e.editDialogVisible},on:{"update:visible":function(t){e.editDialogVisible=t},close:function(t){return e.handleCloseDialog("editForm")}}},[t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules,"status-icon":"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"标签名称",prop:"tag_name"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.editForm.tag_name,callback:function(t){e.$set(e.editForm,"tag_name",t)},expression:"editForm.tag_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleEdit}},[e._v("保 存")])],1)],1)],1)},s=[],l=(a(7658),a(9551)),r={name:"List",data(){return{tableData:[],insertDialogVisible:!1,insertForm:{tag_name:"",create_date:(new Date).toLocaleString(),update_date:(new Date).toLocaleString()},editDialogVisible:!1,editForm:{tag_id:void 0},current_tag:"",rules:{tag_name:[{required:!0,message:"请输入标签名称！",trigger:"blur"}]}}},created(){this.loadList()},computed:{loacleTimestamp(){return e=>new Date(e).toLocaleString()}},methods:{async loadList(){let{status:e,msg:t,data:a}=await l.Vp.list({pagesize:100});e&&(this.tableData=a)},handleInsert(){this.$refs.insertForm.validate((async e=>{if(e){let{status:e,msg:t,data:a}=await l.Vp.create({...this.insertForm});e?(this.tableData.push({...this.insertForm,...a}),this.insertDialogVisible=!1,this.$message.success(t)):this.$message.error(t)}}))},handleCloseDialog(e){this.$refs[e].resetFields()},openEditDialog(e){this.current_tag=e,this.editForm={...e},this.editDialogVisible=!0},async handleEdit(){let{tag_id:e}=this.editForm;try{let t=await this.$refs.editForm.validate();if(t){let{status:t,msg:a}=await l.Vp.edit(e,{...this.editForm});t?(Object.assign(this.current_tag,this.editForm),this.current_tag.update_date=(new Date).toLocaleString(),this.editDialogVisible=!1,this.$message.success(a)):this.$message.error(a)}}catch(t){console.log(t)}},handleRemove(e,t){this.$confirm("此操作将永久删除该标签, 是否继续?","确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then((async()=>{let{status:a,msg:i}=await l.Vp.remove(e);a?(this.tableData.splice(t,1),this.$message({type:"success",message:i})):this.$message.error(i)})).catch((()=>{this.$message.info("已取消删除")}))}}},o=r,n=a(1001),c=(0,n.Z)(o,i,s,!1,null,"7cd5b710",null),m=c.exports}}]);
//# sourceMappingURL=149.32d71b5d.js.map