"use strict";(self["webpackChunkvue2_cms_admin"]=self["webpackChunkvue2_cms_admin"]||[]).push([[316],{4316:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var l=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"list_head",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("链接列表")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"promotion:link:create",expression:"'promotion:link:create'"}],attrs:{type:"primary",icon:"el-icon-circle-plus-outline",plain:"",size:"mini"},on:{click:function(t){e.insertDialogVisible=!0}}},[e._v("添加链接")])],1),t("el-table",{attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"link_id",label:"#",width:"100"}}),t("el-table-column",{attrs:{prop:"title",label:"链接标题"}}),t("el-table-column",{attrs:{label:"网站地址"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-link",{attrs:{href:i.row.url,target:"_blank",underline:!1}},[e._v(e._s(i.row.url))])]}}])}),t("el-table-column",{attrs:{prop:"link_order",label:"排序数字"}}),t("el-table-column",{attrs:{prop:"usable",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(i){return[-1===i.row.usable?t("el-tag",{attrs:{type:"info",plain:"",disabled:"",size:"mini"}},[e._v("禁用")]):t("el-tag",{attrs:{type:"success",plain:"",size:"mini"}},[e._v("启用")])]}}])}),t("el-table-column",{attrs:{prop:"create_time",label:"添加日期"}}),t("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"promotion:link:edit",expression:"'promotion:link:edit'"}],attrs:{type:"primary",icon:"el-icon-edit",plain:"",size:"mini"},on:{click:function(t){return e.openEditDialog(i.row)}}},[e._v("编辑")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"promotion:link:switch",expression:"'promotion:link:switch'"}],attrs:{type:1===i.row.usable?"info":"success",icon:"el-icon-switch-button",plain:"",size:"mini"},on:{click:function(t){return e.handleOpen(i.row.link_id,i.$index)}}},[e._v(e._s(-1==i.row.usable?"启用":"禁用"))]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"promotion:link:remove",expression:"'promotion:link:remove'"}],attrs:{plain:"",size:"mini",icon:"el-icon-delete",type:"danger"},on:{click:function(t){return e.handleRemove(i.row.link_id,i.$index)}}},[e._v("删除")])]}}])})],1),t("el-dialog",{attrs:{title:"添加标签",visible:e.insertDialogVisible},on:{"update:visible":function(t){e.insertDialogVisible=t},close:function(t){return e.handleCloseDialog("insertForm")}}},[t("el-form",{ref:"insertForm",attrs:{model:e.insertForm,rules:e.rules,"status-icon":"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"链接标题",prop:"title"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.insertForm.title,callback:function(t){e.$set(e.insertForm,"title",t)},expression:"insertForm.title"}})],1),t("el-form-item",{attrs:{label:"链接地址",prop:"url"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.insertForm.url,callback:function(t){e.$set(e.insertForm,"url",t)},expression:"insertForm.url"}})],1),t("el-form-item",{attrs:{label:"显示顺序",prop:"link_order"}},[t("el-input",{attrs:{type:"number",autocomplete:"off"},model:{value:e.insertForm.link_order,callback:function(t){e.$set(e.insertForm,"link_order",t)},expression:"insertForm.link_order"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.insertDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleInsert}},[e._v("添 加")])],1)],1),t("el-dialog",{attrs:{title:"编辑标签",visible:e.editDialogVisible},on:{"update:visible":function(t){e.editDialogVisible=t},close:function(t){return e.handleCloseDialog("editForm")}}},[t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules,"status-icon":"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"链接标题",prop:"title"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.editForm.title,callback:function(t){e.$set(e.editForm,"title",t)},expression:"editForm.title"}})],1),t("el-form-item",{attrs:{label:"链接地址",prop:"url"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.editForm.url,callback:function(t){e.$set(e.editForm,"url",t)},expression:"editForm.url"}})],1),t("el-form-item",{attrs:{label:"显示顺序",prop:"link_order"}},[t("el-input",{attrs:{type:"number",autocomplete:"off"},model:{value:e.editForm.link_order,callback:function(t){e.$set(e.editForm,"link_order",t)},expression:"editForm.link_order"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleEdit}},[e._v("保 存")])],1)],1)],1)},s=[],r=(i(7658),i(9551)),a={name:"List",data(){return{tableData:[],insertDialogVisible:!1,insertForm:{create_time:(new Date).toLocaleString()},editDialogVisible:!1,editForm:{title:"",url:"",link_order:""},current_link:"",rules:{title:[{required:!0,message:"请输入链接名称！",trigger:"blur"}],url:[{required:!0,message:"请输入网站地址！",trigger:"blur"},{pattern:/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?/,message:"请正确输入网站地址！",trigger:"blur"}],link_order:[{required:!0,message:"请输入排序位置(数字)！",trigger:"blur"}]}}},created(){this.loadList()},methods:{async loadList(){let{status:e,msg:t,data:i}=await r.rU.list({pagesize:12});e&&(this.tableData=i)},handleInsert(){this.$refs.insertForm.validate((async e=>{if(e){let{status:e,msg:t,data:i}=await r.rU.create({...this.insertForm});e?(this.tableData.push({...this.insertForm,...i}),this.insertDialogVisible=!1,this.$message.success(t)):this.$message.error(t)}}))},handleCloseDialog(e){this.$refs[e].resetFields()},handleRemove(e,t){this.$confirm("此操作将永久删除该链接, 是否继续?","确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then((async()=>{let{status:i,msg:l}=await r.rU.remove(e);i?(this.tableData.splice(t,1),this.$message.success(l)):this.$message.error(l)})).catch((()=>{this.$message.info("已取消删除")}))},handleOpen(e,t){this.$confirm(`此操作将${1==this.tableData[t].usable?"禁用":"启用"}该链接, 是否继续?,`,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{let i=-this.tableData[t].usable,{status:l,msg:s}=await r.rU.usable({link_id:e,usable:i});l?(this.tableData[t].usable=-this.tableData[t].usable,this.$message.success(s)):this.$message.error(s)})).catch((()=>{this.$message.info("已取消启用")}))},openEditDialog(e){this.current_link=e,this.editForm={...e},this.editDialogVisible=!0},async handleEdit(){let{link_id:e}=this.editForm;try{let t=await this.$refs.editForm.validate();if(t){let{status:t,msg:i}=await r.rU.edit(e,{...this.editForm});t?(Object.assign(this.current_link,this.editForm),this.editDialogVisible=!1,this.$message.success(i)):this.$message.error(i)}}catch(t){console.log(t)}}}},o=a,n=i(1001),u=(0,n.Z)(o,l,s,!1,null,"91810980",null),c=u.exports}}]);
//# sourceMappingURL=316.15e2e440.js.map