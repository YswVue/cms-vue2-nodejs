"use strict";(self["webpackChunkvue2_cms_admin"]=self["webpackChunkvue2_cms_admin"]||[]).push([[498],{7498:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("菜单权限")])]),t("el-alert",{attrs:{title:"Tips",type:"warning",description:"设置后台管理系统的左侧菜单，目前至多支持两层菜单，三层以上菜单将不会显示。","show-icon":"",closable:!1}}),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-key":"permission_id",lazy:"",border:"","default-expand-all":"","max-height":"700"}},[t("el-table-column",{attrs:{fixed:"left",label:"资源名称",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("操作"===t.row.resource_type_name?t.row.permission_remark:t.row.menu_name)+" ")]}}])}),t("el-table-column",{attrs:{prop:"icon_id",label:"图标"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("i",{class:`el-icon-${e.row.icon_name}`})]}}])}),t("el-table-column",{attrs:{label:"资源类型"},scopedSlots:e._u([{key:"default",fn:function(i){return["操作"===i.row.resource_type_name?t("el-tag",{attrs:{type:"warning"}},[e._v(e._s(i.row.resource_type_name))]):t("el-tag",[e._v(e._s(i.row.resource_type_name))])]}}])}),t("el-table-column",{attrs:{prop:"resource_type_code",label:"资源代码",width:"120"}}),t("el-table-column",{attrs:{prop:"permission_code",label:"权限代码",width:"180"}}),t("el-table-column",{attrs:{prop:"operation_name",label:"操作名称",width:"120"}}),t("el-table-column",{attrs:{prop:"menu_name",label:"菜单名称",width:"200"}}),t("el-table-column",{attrs:{prop:"menu_full_path",label:"完整菜单地址",width:"200"}}),t("el-table-column",{attrs:{prop:"menu_order",label:"菜单序号",width:"120"}}),t("el-table-column",{attrs:{prop:"permission_remark",label:"备注",width:"120"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"240"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"system:route:remove",expression:"'system:route:remove'"}],attrs:{type:"primary",plain:""},on:{click:function(t){return e.openEditDialog(i.row)}}},[t("i",{staticClass:"el-icon-edit"})]),"操作"!==i.row.resource_type_name?t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"system:menu:create",expression:"'system:menu:create'"}],attrs:{type:"success",plain:""},on:{click:function(t){return e.openInsertDialog(i.row)}}},[t("i",{staticClass:"el-icon-circle-plus-outline"})]):e._e(),"操作"!==i.row.resource_type_name?t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"system:menu:setting",expression:"'system:menu:setting'"}],attrs:{type:"warning",plain:""},on:{click:function(t){return e.openIconDialog(i.row)}}},[t("i",{staticClass:"el-icon-setting"})]):e._e(),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"system:menu:remove",expression:"'system:menu:remove'"}],attrs:{type:"danger",plain:""},on:{click:function(t){return e.handleRemove(i.row)}}},[t("i",{staticClass:"el-icon-delete"})])]}}])})],1),t("el-dialog",{attrs:{title:"添加菜单",visible:e.insert_dialog_visible},on:{"update:visible":function(t){e.insert_dialog_visible=t},close:function(t){return e.handleCloseDialog("insert_form")}}},[t("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"用户管理",name:"first"}},[t("el-form",{ref:"insert_form",attrs:{model:e.insert_form,rules:e.rules,"status-icon":"","label-width":"150px"}},[t("el-form-item",{attrs:{label:"菜单名称",prop:"menu_name"}},[t("el-input",{attrs:{type:"text"},model:{value:e.insert_form.menu_name,callback:function(t){e.$set(e.insert_form,"menu_name",t)},expression:"insert_form.menu_name"}})],1),t("el-form-item",{attrs:{label:"关联路由",prop:"route_id"}},[t("el-cascader",{attrs:{options:e.route_1st,props:e.route_props,clearable:""},model:{value:e.insert_form.route_id,callback:function(t){e.$set(e.insert_form,"route_id",t)},expression:"insert_form.route_id"}})],1),t("el-form-item",{attrs:{label:"显示顺序",prop:"menu_order"}},[t("el-input",{attrs:{type:"text"},model:{value:e.insert_form.menu_order,callback:function(t){e.$set(e.insert_form,"menu_order",t)},expression:"insert_form.menu_order"}})],1),t("el-form-item",{attrs:{label:"权限代码",prop:"permission_code"}},[t("el-input",{attrs:{type:"text"},model:{value:e.insert_form.permission_code,callback:function(t){e.$set(e.insert_form,"permission_code",t)},expression:"insert_form.permission_code"}})],1),t("el-form-item",{attrs:{label:"权限备注",prop:"permission_remark  "}},[t("el-input",{attrs:{type:"text"},model:{value:e.insert_form.permission_remark,callback:function(t){e.$set(e.insert_form,"permission_remark",t)},expression:"insert_form.permission_remark"}})],1)],1)],1),t("el-tab-pane",{attrs:{label:"操作按钮",name:"second"}},[t("el-form",{ref:"insert_form",attrs:{model:e.insert_form,rules:e.rules,"status-icon":"","label-width":"150px"}},[t("el-form-item",{attrs:{label:"操作类型"}},[t("el-select",{attrs:{placeholder:"请选择操作按钮类型",prop:"operation_name"},model:{value:e.insert_form.operation_id,callback:function(t){e.$set(e.insert_form,"operation_id",t)},expression:"insert_form.operation_id"}},e._l(e.operation,(function(e){return t("el-option",{key:e.operation_id,attrs:{label:e.operation_name,value:e.operation_id}})})),1)],1),t("el-form-item",{attrs:{label:"权限代码",prop:"permission_code"}},[t("el-input",{attrs:{type:"text",placeholder:"权限代码由父级权限和按钮权限组成"},model:{value:e.insert_form.permission_code,callback:function(t){e.$set(e.insert_form,"permission_code",t)},expression:"insert_form.permission_code"}})],1),t("el-form-item",{attrs:{label:"权限备注",prop:"permission_remark  "}},[t("el-input",{attrs:{type:"text",placeholder:"请输入权限备注信息"},model:{value:e.insert_form.permission_remark,callback:function(t){e.$set(e.insert_form,"permission_remark",t)},expression:"insert_form.permission_remark"}})],1)],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.insert_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleInsert}},[e._v("添 加")])],1)],1),t("el-dialog",{attrs:{title:"编辑菜单",visible:e.edit_dialog_visible},on:{"update:visible":function(t){e.edit_dialog_visible=t},close:function(t){return e.handleCloseDialog("edit_form")}}},[t("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"用户管理",disabled:"MENU"!==e.edit_form.resource_type_code,name:"first"}},[t("el-form",{ref:"edit_form",attrs:{model:e.edit_form,rules:e.rules,"status-icon":"","label-width":"150px"}},[t("el-form-item",{attrs:{label:"菜单名称",prop:"menu_name"}},[t("el-input",{attrs:{type:"text"},model:{value:e.edit_form.menu_name,callback:function(t){e.$set(e.edit_form,"menu_name",t)},expression:"edit_form.menu_name"}})],1),t("el-form-item",{attrs:{label:"关联路由",prop:"route_id"}},[t("el-cascader",{attrs:{options:e.route_1st,props:e.route_props,clearable:""},model:{value:e.edit_form.route_id,callback:function(t){e.$set(e.edit_form,"route_id",t)},expression:"edit_form.route_id"}})],1),t("el-form-item",{attrs:{label:"显示顺序",prop:"menu_order"}},[t("el-input",{attrs:{type:"text"},model:{value:e.edit_form.menu_order,callback:function(t){e.$set(e.edit_form,"menu_order",t)},expression:"edit_form.menu_order"}})],1),t("el-form-item",{attrs:{label:"权限代码",prop:"permission_code"}},[t("el-input",{attrs:{type:"text"},model:{value:e.edit_form.permission_code,callback:function(t){e.$set(e.edit_form,"permission_code",t)},expression:"edit_form.permission_code"}})],1),t("el-form-item",{attrs:{label:"权限备注",prop:"role_description"}},[t("el-input",{attrs:{type:"text"},model:{value:e.edit_form.role_description,callback:function(t){e.$set(e.edit_form,"role_description",t)},expression:"edit_form.role_description"}})],1)],1)],1),t("el-tab-pane",{attrs:{label:"操作按钮",disabled:"OPERATION"!==e.edit_form.resource_type_code,name:"second"}},[t("el-form",{ref:"edit_form",attrs:{model:e.edit_form,rules:e.rules,"status-icon":"","label-width":"150px"}},[t("el-form-item",{attrs:{label:"操作类型"}},[t("el-select",{attrs:{placeholder:"请选择操作按钮类型",prop:"operation_id"},model:{value:e.edit_form.operation_id,callback:function(t){e.$set(e.edit_form,"operation_id",t)},expression:"edit_form.operation_id"}},e._l(e.operation,(function(e){return t("el-option",{key:e.operation_id,attrs:{label:e.operation_name,value:e.operation_id}})})),1)],1),t("el-form-item",{attrs:{label:"权限代码",prop:"permission_code"}},[t("el-input",{attrs:{type:"text",placeholder:"权限代码由父级权限和按钮权限组成"},model:{value:e.edit_form.permission_code,callback:function(t){e.$set(e.edit_form,"permission_code",t)},expression:"edit_form.permission_code"}})],1),t("el-form-item",{attrs:{label:"权限备注",prop:"role_description"}},[t("el-input",{attrs:{type:"text",placeholder:"请输入权限备注信息"},model:{value:e.edit_form.role_description,callback:function(t){e.$set(e.edit_form,"role_description",t)},expression:"edit_form.role_description"}})],1)],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.edit_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleEdit}},[e._v("保 存")])],1)],1),t("el-dialog",{attrs:{width:"75%",title:"选择图标",visible:e.icon_dialog_visible},on:{"update:visible":function(t){e.icon_dialog_visible=t}}},[t("div",{staticClass:"outer"},e._l(e.icon_list,(function(i){return t("div",{key:i.icon_id,staticClass:"inter",class:{click:e.current_icon.icon_id===i.icon_id},on:{click:function(t){return e.handleInsertIcon(i)}}},[t("div",[t("i",{class:`el-icon-${i.icon_name}`,staticStyle:{"font-size":"26px","text-align":"center","line-height":"70px"}})]),t("span",[e._v("el-icon-"+e._s(i.icon_name))])])})),0),t("el-pagination",{staticStyle:{float:"right"},attrs:{background:"",layout:"prev, pager, next",total:280,"page-size":30},on:{"current-change":e.handleCurrentChange}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.icon_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleIcon}},[e._v("添 加")])],1)],1)],1)},s=[],o=i(3822),a={name:"list",data(){return{tableData:[],activeName:"first",insert_dialog_visible:!1,insert_form:{menu_name:"",route_id:"",menu_order:"",permission_code:"",permission_remark:"",resource_type_name:"",resource_type_code:"",operation_id:"",operation_name:""},cascader:"",route_1st:"",route_props:{checkStrictly:!0,label:"route_name",value:"route_id",emitPath:!1},edit_dialog_visible:!1,edit_form:{menu_name:"",route_id:"",menu_order:"",permission_code:"",permission_remark:"",resource_type_name:"",resource_type_code:"",operation_id:"",operation_name:""},current_menu:"",current_icon:"",icon_dialog_visible:!1,rules:{menu_name:[{required:!0,message:"请输入菜单名称！",tigger:"blur"}],route_id:[{type:"number",required:!0,message:"请选择与之关联的路由！",tigger:"blur"}],menu_order:[{required:!0,message:"请填写显示顺序！",tigger:"blur"}],permission_code:[{required:!0,message:"请输入权限代码！",tigger:"blur"}],role_description:[{required:!0,message:"请输入权限备注！",tigger:"blur"}]}}},created(){this.loadList(),document.title="菜单管理",this.route_1st=this.tree_data},watch:{tree_menu(e){this.tableData=e}},computed:{...(0,o.rn)("operation",["operation"]),...(0,o.Se)("route",["tree_data"]),...(0,o.Se)("menu",["tree_menu"]),...(0,o.rn)("menu",["icon_list"])},methods:{...(0,o.nv)("menu",["load_menu"]),async loadList(){let{status:e,msg:t,data:i}=await this.load_menu({});e&&(this.tableData=this.tree_menu)},...(0,o.nv)("menu",["create_menu"]),...(0,o.nv)("menu",["create_operation"]),openInsertDialog(e){this.insert_dialog_visible=!0,this.current_menu={...e},this.insert_form.parent_id=current_menu.permission_id,this.insert_form.permission_code=current_menu.permission_code},handleInsert(){"first"===this.activeName?(this.insert_form.resource_type_name="菜单",this.resource_type_code="MENU",this.$refs.insert_form.validate((async e=>{if(e){let{status:e,msg:t,data:i}=await this.create_menu({...this.insert_form});e?(this.insert_dialog_visible=!1,this.$message.success(t)):this.$message.error(t)}}))):"second"===this.activeName&&(this.insert_form.resource_type_name="操作",this.resource_type_code="OPERATION",this.$refs.insert_form.validate((async e=>{if(e){let{status:e,msg:t,data:i}=await this.create_operation({...this.insert_form});e?(this.insert_dialog_visible=!1,this.$message.success(t)):this.$message.error(t)}})))},openEditDialog(e){this.current_menu={...e},this.edit_dialog_visible=!0,this.edit_form={...e},"MENU"===this.edit_form.resource_type_code?this.activeName="first":"OPERATION"===this.edit_form.resource_type_code&&(this.activeName="second")},...(0,o.nv)("menu",["edit_menu"]),...(0,o.nv)("menu",["edit_operation"]),async handleEdit(){if("first"===this.activeName){let{menu_id:t}=this.edit_form;try{let e=await this.$refs.edit_form.validate();if(e){let e=[t,{...this.edit_form}],{status:i,msg:r,data:s}=await this.edit_menu(e);i?(this.edit_dialog_visible=!1,this.$message.success(r)):this.$message.error(r)}}catch(e){console.log(e)}}else if("second"===this.activeName){let{permission_id:t}=this.edit_form;try{let e=await this.$refs.edit_form.validate();if(e){let e=[t,{...this.edit_form}],{status:i,msg:r,data:s}=await this.edit_operation(e);i?(this.edit_dialog_visible=!1,this.$message.success(r)):this.$message.error(r)}}catch(e){console.log(e)}}},handleCloseDialog(e){this.$refs[e].resetFields()},...(0,o.nv)("menu",["remove_menu"]),...(0,o.nv)("menu",["remove_operation"]),handleRemove(e){if("MENU"===e.resource_type_code){let{menu_id:t,permission_id:i}=e;this.$confirm("此操作将永久删除该菜单, 是否继续?","确认删除",{type:"warning"}).then((async()=>{let{status:e,msg:r}=await this.remove_menu([t,{permission_id:i}]);e?this.$message.success(r):this.$message.error(r)})).catch((()=>{this.$message.info("已取消删除")}))}else if("OPERATION"===e.resource_type_code){let{permission_id:t}=e;console.log(t),this.$confirm("此操作将永久删除该操作方式, 是否继续?","确认删除",{type:"warning"}).then((async()=>{let{status:e,msg:i}=await this.remove_operation(t);e?this.$message.success(i):this.$message.error(i)})).catch((()=>{this.$message.info("已取消删除")}))}},...(0,o.nv)("menu",["load_icon"]),async openIconDialog(e){this.current_menu=e,this.icon_dialog_visible=!0;let{status:t,msg:i}=await this.load_icon({pageSize:30,pageIndex:1});t||this.$message.error(i)},handleInsertIcon(e){this.current_icon={...e}},...(0,o.nv)("menu",["create_icon"]),async handleIcon(){if(this.current_icon){let e={...this.current_menu,...this.current_icon},{status:t,msg:i}=await this.create_icon(e);t?(this.icon_dialog_visible=!1,this.$message.success(i)):this.$message.error(i)}else this.$message.error("请选择图标")},async handleCurrentChange(e){let{status:t,msg:i}=await this.load_icon({pageSize:30,pageIndex:e});t||this.$message.error(i)}}},n=a,l=i(1001),m=(0,l.Z)(n,r,s,!1,null,"3f5b0c3a",null),c=m.exports}}]);
//# sourceMappingURL=498.50417f76.js.map