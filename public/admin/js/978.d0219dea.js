"use strict";(self["webpackChunkvue2_cms_admin"]=self["webpackChunkvue2_cms_admin"]||[]).push([[978],{5969:function(e,t,a){a.d(t,{Z:function(){return n}});var s=function(){var e=this,t=e._self._c;return t("el-upload",{staticClass:"avatar-uploader",attrs:{"on-success":e.handleUploadSuccess,"on-error":e.handleUploadError,"before-upload":e.beforeAvatarUpload,accept:"image/*","show-file-list":!1,data:e.data,action:e.action,headers:e.headers}},[e.picture?t("img",{staticClass:"avatar",attrs:{src:e.picture}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])},r=[],o={model:{prop:"picture",event:"change"},props:{data:{type:Object,default:()=>({type:"common"})},headers:{type:Object,default:()=>({Authorization:`Bearer ${sessionStorage.access_token}`})},action:{type:String,default:"/upload/common/"},picture:{type:String,default:""}},data(){return{}},methods:{beforeAvatarUpload(e){let t=/^image\/(jpeg||png)$/;const a=t.test(e.type),s=e.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),s||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&s},handleUploadError(e,t,a){let{status:s,message:r}=e;switch(s){case 400:let{status:e,msg:t}=JSON.parse(r);this.$message.error(t);break;case 401:let{code:a}=JSON.parse(r);this.$message.error(`错误代码401,${a},请重新登录`);break;default:break}},handleUploadSuccess(e,t,a){let{status:s,msg:r,src:o}=e;s&&(this.$emit("change",o),this.$message.success(r))}}},l=o,i=a(1001),c=(0,i.Z)(l,s,r,!1,null,"b38c2fa8",null),n=c.exports},9678:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"box-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v("发布文章")])]),t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"标题",prop:"title"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),t("el-form-item",{attrs:{label:"描述",prop:"description"}},[t("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),t("el-form-item",{attrs:{label:"分类"}},[t("el-col",{attrs:{span:6}},[t("el-select",{attrs:{placeholder:"请选择一级分类"},model:{value:e.form.cate_1st,callback:function(t){e.$set(e.form,"cate_1st",t)},expression:"form.cate_1st"}},e._l(e.cate_1st_options,(function(e){return t("el-option",{key:e.cate_id,attrs:{label:e.cate_name,value:e.cate_id}})})),1)],1),t("el-col",{attrs:{span:6}},[t("el-select",{attrs:{placeholder:"请选择二级分类"},model:{value:e.form.cate_2nd,callback:function(t){e.$set(e.form,"cate_2nd",t)},expression:"form.cate_2nd"}},e._l(e.cate_2nd_options,(function(e){return t("el-option",{key:e.cate_id,attrs:{label:e.cate_name,value:e.cate_id}})})),1)],1)],1),t("el-form-item",{attrs:{label:"图片",prop:"main_photo"}},[t("ImgUpload",{model:{value:e.form.main_photo,callback:function(t){e.$set(e.form,"main_photo",t)},expression:"form.main_photo"}})],1),t("el-form-item",{attrs:{label:"内容",prop:"content"}},[t("txtEditor",{attrs:{content:e.form.content},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.handleRelease}},[e._v("发布文章")])],1)],1)],1)},r=[],o=(a(7658),a(9551)),l=a(5969),i=a(51),c={name:"Release",components:{ImgUpload:l.Z,txtEditor:i.Z},data(){return{form:{cate_1st:"",cate_2nd:"",title:"",description:"",main_photo:"",content:""},cate_1st_options:[],cate_2nd_options:[],rules:{main_photo:[{required:!0,message:"请上传图片！",trigger:"blur"}],title:[{required:!0,message:"请输入文章标题！",trigger:"blur"}],description:[{required:!0,message:"请输入文章描述！",trigger:"blur"}],content:[{required:!0,message:"请输入文章内容！",trigger:"blur"}]}}},async created(){this.cate_1st_options=await this.loadSubcate(0),this.form.cate_1st=this.cate_1st_options[0]?.cate_id},watch:{"form.cate_1st":async function(e,t){this.cate_2nd_options=await this.loadSubcate(e),this.form.cate_2nd=this.cate_2nd_options[0]?.cate_id}},methods:{async loadSubcate(e){let{status:t,msg:a,data:s}=await o.WD.subCate({cate_id:e});if(t)return s},async handleRelease(){try{let e=await this.$refs.form.validate();if(e){let{status:e,msg:t}=await o.d2.release({...this.form});e?(this.$message.success(t),this.$router.push("/article/list")):this.$message.error(t)}}catch(e){this.$message.error(e)}}}},n=c,m=a(1001),u=(0,m.Z)(n,s,r,!1,null,"361b9062",null),d=u.exports}}]);
//# sourceMappingURL=978.d0219dea.js.map