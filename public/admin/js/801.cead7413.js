"use strict";(self["webpackChunkvue2_cms_admin"]=self["webpackChunkvue2_cms_admin"]||[]).push([[801],{8801:function(e,t,l){l.r(t),l.d(t,{default:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"box-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v("评论列表")])]),t("el-table",{attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"comment_id",label:"#",width:"100"}}),t("el-table-column",{attrs:{prop:"article_title",label:"文章标题"}}),t("el-table-column",{attrs:{prop:"user_nickname",label:"用户"}}),t("el-table-column",{attrs:{prop:"content",label:"留言内容"}}),t("el-table-column",{attrs:{label:"留言日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.create_time))]}}])}),t("el-table-column",{attrs:{prop:"reply",label:"回复内容"}}),t("el-table-column",{attrs:{label:"回复日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.loacleTimestamp(t.row.reply_date))+" ")]}}])}),t("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-tag",{attrs:{type:1===l.row.is_visible?"success":"info"}},[e._v(" "+e._s(1===l.row.is_visible?"显示":"隐藏")+" ")])]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"article:comment:reply",expression:"'article:comment:reply'"}],attrs:{type:"primary",icon:"el-icon-edit",plain:"",size:"mini"},on:{click:function(t){return e.openReplyDialog(l.row)}}},[e._v("回复")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"article:comment:switch",expression:"'article:comment:switch'"}],attrs:{plain:"",size:"mini",icon:"el-icon-switch-button",type:1===l.row.is_visible?"info":"success"},on:{click:function(t){return e.handleVisible(l.row.comment_id,l.$index)}}},[e._v(" "+e._s(1===l.row.is_visible?"隐藏":"显示")+" ")])]}}])})],1),t("el-dialog",{attrs:{title:"回复评论",visible:e.replyDialogVisible},on:{"update:visible":function(t){e.replyDialogVisible=t},close:function(t){return e.handleCloseDialog("replyForm")}}},[t("el-descriptions",{attrs:{direction:"vertical",column:2,border:""}},[t("el-descriptions-item",{attrs:{label:"评论用户"}},[e._v(" "+e._s(e.current_reply.user_nickname)+" ")]),t("el-descriptions-item",{attrs:{label:"评论文章"}},[e._v(e._s(e.current_reply.article_title))]),t("el-descriptions-item",{attrs:{label:"评论内容"}},[e._v(" "+e._s(e.current_reply.content)+" ")])],1),t("el-form",{ref:"replyForm",staticClass:"replyForm",attrs:{model:e.replyForm,rules:e.rules,"status-icon":""}},[t("el-form-item",{attrs:{prop:"reply"}},[t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:e.replyForm.reply,callback:function(t){e.$set(e.replyForm,"reply",t)},expression:"replyForm.reply"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.replyDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleRelpy}},[e._v("保 存")])],1)],1),t("el-pagination",{attrs:{"current-page":e.currentPage,background:"",layout:"prev, pager, next",total:10*e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)},r=[],s=l(9551),i={name:"List",data(){return{tableData:[],currentPage:1,total:"",replyDialogVisible:!1,replyForm:{reply:"",article_title:"",user_nickname:"",content:""},current_reply:"",rules:{reply:[{required:!0,message:"请输入回复内容！",trigger:"blur"}]}}},computed:{loacleTimestamp(){return e=>new Date(e).toLocaleString()}},created(){this.loadList()},methods:{async loadList(){let{status:e,msg:t,data:l,total:a}=await s.sv.list({pagesize:3});e&&(this.tableData=l,this.total=a)},handleVisible(e,t){this.$confirm(`此操作将${1==this.tableData[t].is_visible?"隐藏":"显示"}该评论, 是否继续?,`,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{let l=-this.tableData[t].is_visible,{status:a,msg:r}=await s.sv.visible({comment_id:e,visible:l});a?(this.tableData[t].is_visible=-this.tableData[t].is_visible,this.$message.success(r)):this.$message.error(r)})).catch((()=>{this.$message.info("已取消操作")}))},handleCloseDialog(e){this.$refs[e].resetFields()},openReplyDialog(e){this.current_reply=e,this.replyForm={...e},this.replyDialogVisible=!0},async handleRelpy(){try{let e=await this.$refs.replyForm.validate();if(e){let{status:e,msg:t}=await s.sv.reply({...this.replyForm});e?(Object.assign(this.current_reply,this.replyForm),this.current_reply.reply_date=(new Date).toLocaleString(),this.replyDialogVisible=!1,this.$message.success(t)):this.$message.error(t)}}catch(e){this.$message.info("已取消操作！")}},async handleCurrentChange(){let{status:e,msg:t,data:l}=await s.sv.list({pagesize:3,pageindex:this.currentPage});e&&(this.tableData=l)}}},n=i,o=l(1001),c=(0,o.Z)(n,a,r,!1,null,"6367ea34",null),u=c.exports}}]);
//# sourceMappingURL=801.cead7413.js.map