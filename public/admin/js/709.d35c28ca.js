"use strict";(self["webpackChunkvue2_cms_admin"]=self["webpackChunkvue2_cms_admin"]||[]).push([[709],{7709:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});var i=function(){var t=this,e=t._self._c;return e("el-card",[e("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[e("div",{staticClass:"left"},[e("span",[t._v("文章列表")])]),e("div",{staticClass:"right"},[e("el-input",{staticClass:"select-input",attrs:{placeholder:"请输入关键词",width:"120px"},model:{value:t.select_input,callback:function(e){t.select_input=e},expression:"select_input"}}),e("el-button",{attrs:{type:"primary"},on:{click:t.handleSelect}},[t._v("查询文章")])],1)]),e("el-table",{attrs:{data:t.tableData}},[e("el-table-column",{attrs:{prop:"article_id",label:"#",width:"50"}}),e("el-table-column",{attrs:{prop:"cate_1st_name",label:"一级分类"}}),e("el-table-column",{attrs:{prop:"cate_2nd_name",label:"二级分类"}}),e("el-table-column",{attrs:{label:"主图"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-image",{attrs:{src:t.row.main_photo}})]}}])}),e("el-table-column",{attrs:{prop:"title",label:"标题",width:"110"}}),e("el-table-column",{attrs:{label:"标签",width:"260"},scopedSlots:t._u([{key:"default",fn:function(a){return t._l(a.row.tags,(function(a){return e("el-tag",{staticStyle:{margin:"5px"},attrs:{size:"medium",type:"success"}},[t._v(" "+t._s(a.tag_name)+" ")])}))}}])}),e("el-table-column",{attrs:{prop:"create_time",label:"发布日期",width:"95"}}),e("el-table-column",{attrs:{prop:"update_time",label:"更新日期",width:"95"}}),e("el-table-column",{attrs:{label:"操作",width:"280"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[e("el-link",{staticStyle:{"margin-right":"10px"},attrs:{href:`#/article/edit/${a.row.article_id}`}},[e("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"article:list:edit",expression:"'article:list:edit'"}],attrs:{size:"mini",type:"primary",icon:"el-icon-edit",plain:""}},[t._v("编辑")])],1),e("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"article:list:tag",expression:"'article:list:tag'"}],attrs:{size:"mini",type:"success",icon:"el-icon-collection-tag",plain:""},on:{click:function(e){return t.openTagDialog(a.$index,a.row)}}},[t._v("标记")])],1),e("div",{staticClass:"btn"},[e("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"article:list:audit",expression:"'article:list:audit'"}],attrs:{size:"mini",type:"warning",icon:"el-icon-collection-tag",plain:""},on:{click:function(e){return t.openAuditDialog(a.row)}}},[t._v("审核")]),e("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"article:list:remove",expression:"'article:list:remove'"}],attrs:{size:"mini",type:"danger",icon:"el-icon-delete",plain:""},on:{click:function(e){return t.handleRemove(a.row,a.$index)}}},[t._v("删除")])],1)]}}])})],1),e("el-dialog",{attrs:{title:"标记文章",visible:t.tag_dialog_visible},on:{"update:visible":function(e){t.tag_dialog_visible=e},close:function(e){t.select_tag=""}}},[e("el-form",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[t._v(" 您可以添加多个标签： ")])]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"tag-select grid-content bg-purple"},[e("el-input",{attrs:{placeholder:"找不到标签？请在此搜索",width:"120px"},model:{value:t.select_tag,callback:function(e){t.select_tag=e},expression:"select_tag"}}),e("el-button",{attrs:{type:"success"},on:{click:t.handle_select_tag}},[t._v("模糊搜索")])],1)]),e("el-col",{attrs:{span:4}},[e("div",{staticClass:"grid-content bg-purple"},[e("el-button",{staticClass:"add",attrs:{type:"success",plain:"",icon:"el-icon-circle-plus-outline"}},[t._v(" 添加标签 ")])],1)])],1),[e("div",{staticClass:"input"},t._l(t.tagSelected,(function(a,i){return e("el-tag",{attrs:{type:"success",closable:""},on:{close:function(e){return t.handleClose(a)}}},[t._v(" "+t._s(a.tag_name)+" ")])})),1)]],2),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.tag_dialog_visible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.handleTagAdd}},[t._v("确 定")])],1),e("div",t._l(t.tags,(function(a,i){return e("el-tag",{staticClass:"tag",attrs:{type:"success"},on:{click:function(e){return t.handleAdd(i)}}},[t._v(" "+t._s(t.tags[i].tag_name)+" ")])})),1)],1),e("el-dialog",{attrs:{title:"审核文章",visible:t.audit_dialog_visible},on:{"update:visible":function(e){t.audit_dialog_visible=e}}},[e("el-form",[[e("el-radio-group",{model:{value:t.audit_status,callback:function(e){t.audit_status=e},expression:"audit_status"}},[e("el-radio",{attrs:{label:1}},[t._v("审核中")]),e("el-radio",{attrs:{label:2}},[t._v("通过")]),e("el-radio",{attrs:{label:-1}},[t._v("未通过")])],1)]],2),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.audit_dialog_visible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.handleAudit}},[t._v("确 定")])],1)],1),e("el-pagination",{attrs:{"current-page":t.currentPage,background:"",layout:"prev, pager, next",total:10*parseInt(t.total)},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)},s=[],l=(a(7658),a(9551)),n={data(){return{tableData:[],tag_dialog_visible:!1,tags:[],tagSelected:[],article_id:"",total:"",currentPage:1,audit_dialog_visible:!1,audit_status:0,current_article:"",article:"",select_input:"",select_tag:"",tags_copy:"",first_flag:!1}},created(){this.loadList()},methods:{async loadList(){let{status:t,msg:e,data:a,total:i}=await l.d2.list({pagesize:3});t&&(this.tableData=a,this.total=i)},async openTagDialog(t,e){this.article=e,this.article_id=this.tableData[t].article_id;let{status:a,msg:i,data:s}=await l.Vp.list();a&&(this.tags=[...s],this.tagSelected=[...this.tableData[t].tags]),this.tag_dialog_visible=!0},handleAdd(t){if(0!=this.tagSelected.length){let e=this.tagSelected.every((e=>e.tag_name!=this.tags[t].tag_name));e&&this.tagSelected.push(this.tags[t])}else this.tagSelected.push(this.tags[t])},handleClose(t){this.tagSelected.splice(this.tagSelected.indexOf(t),1)},async handleTagAdd(){let t=this.article_id,e=[];this.tagSelected.forEach((t=>{e.push(t.tag_id)}));let{status:a,msg:i,data:s}=await l.d2.tag({article_id:t,tags:e});a?(this.$message.success(i),this.tag_dialog_visible=!1,this.article.tags=[...this.tagSelected]):this.$message.info(i)},handleRemove(t,e){this.$confirm("此操作将永久删除该文章，是否继续？","确认删除",{type:"warning"}).then((async()=>{let{status:a,msg:i}=await l.d2.remove(t);a?(this.$message.success(i),this.tableData.splice(e,1)):this.$message.error(i)})).catch((()=>{this.$message.info("已取消删除")}))},async handleCurrentChange(){let{status:t,msg:e,data:a}=await l.d2.list({pagesize:3,pageindex:this.currentPage});t&&(this.tableData=a)},openAuditDialog(t){this.audit_dialog_visible=!0,this.current_article={...t}},async handleAudit(){let{article_id:t}=this.current_article,{status:e,msg:a}=await l.d2.audit({article_id:t,audit_status:this.audit_status});e&&(this.$message.success(a),this.audit_dialog_visible=!1)},async handleSelect(){let{status:t,msg:e,data:a,total:i}=await l.d2.list({pagesize:3,keyword:this.select_input});t&&(this.tableData=a,this.total=i)},async handle_select_tag(){this.first_flag||(this.tags_copy=[...this.tags],this.first_flag=!0);let t=this.tags_copy.filter((t=>t.tag_name.includes(this.select_tag)));this.tags=[...t],this.select_tag||(this.tags=this.tags_copy)}}},c=n,r=a(1001),o=(0,r.Z)(c,i,s,!1,null,"150c5f99",null),d=o.exports}}]);
//# sourceMappingURL=709.d35c28ca.js.map